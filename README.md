# Telegram Bot с Flask Backend

Интеграция Telegram бота с веб-интерфейсом на Flask, использующая OpenAI API для генерации ответов.

## Описание проекта

Этот проект представляет собой Telegram бота с веб-интерфейсом, который позволяет:
- Взаимодействовать с ботом через Telegram
- Управлять ботом через веб-интерфейс
- Сохранять историю сообщений
- Использовать возможности OpenAI для генерации ответов

## Технический стек

- Python 3.x
- Flask
- SQLite
- Telegram Bot API
- OpenAI API
- Poetry (управление зависимостями)

## Установка и настройка

1. Клонируйте репозиторий:
```bash
git clone [URL репозитория]
cd TGbot_flask
```

2. Установите зависимости с помощью Poetry:
```bash
poetry install
```

3. Создайте файл `.env` в корневой директории проекта и добавьте необходимые переменные окружения:
```
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
OPENAI_API_KEY=your_openai_api_key
```

4. Активируйте виртуальное окружение:
```bash
poetry shell
```

## Запуск проекта

1. Запустите Flask сервер:
```bash
python main.py
```

2. Бот будет доступен в Telegram по указанному токену.

## Структура проекта

```
TGbot_flask/
├── bot.py              # Основной файл бота
├── main.py            # Точка входа Flask приложения
├── server.py          # Конфигурация сервера
├── openai_service.py  # Сервис для работы с OpenAI API
├── db.py              # Конфигурация базы данных
├── models.py          # Модели данных
├── config.py          # Конфигурационные параметры
├── templates/         # Шаблоны сообщений
├── bot_history.db     # База данных SQLite
└── poetry.lock        # Файл блокировки зависимостей
```

## Функциональность

### Telegram Bot
- Обработка входящих сообщений
- Генерация ответов с помощью OpenAI
- Сохранение истории сообщений
- Поддержка контекста разговора

### Веб-интерфейс
- Просмотр истории сообщений
- Управление настройками бота
- Мониторинг активности

## База данных

Проект использует SQLite для хранения:
- Истории сообщений
- Информации о пользователях
- Настроек бота

## Безопасность

- API ключи хранятся в переменных окружения
- Реализована защита от SQL-инъекций
- Ограничен доступ к административным функциям

## Разработка

### Добавление новых функций
1. Создайте новую ветку для разработки
2. Внесите необходимые изменения
3. Создайте pull request

### Тестирование
```bash
poetry run pytest
```

## Лицензия

MIT License

## Контакты

[Ваши контактные данные]

## Вклад в проект

Мы приветствуем вклад в развитие проекта! Пожалуйста, ознакомьтесь с нашими правилами для контрибьюторов.
